<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Vols - Travel Admin</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-2.1.8/b-3.2.0/b-colvis-3.2.0/b-html5-3.2.0/b-print-3.2.0/r-3.0.3/datatables.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="fas fa-plane-departure"></i>
            <span>Travel Admin</span>
        </div>
        
         <nav class="nav-menu">
            <a href="index.html" class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>Dashboard</span>
            </a>
            <a href="reservations.html" class="nav-item">
                <i class="fas fa-ticket-alt"></i>
                <span>Réservations</span>
            </a>
            <a href="clients.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>Clients</span>
            </a>
            <a href="vol.html" class="nav-item">
                <i class="fas fa-plane"></i>
                <span>Vols</span>
            </a>
            <a href="paiements.html" class="nav-item">
                <i class="fas fa-money-bill-wave"></i>
                <span>Paiements</span>
            </a>
            <a href="statistiques.html" class="nav-item active">
                <i class="fas fa-chart-bar"></i>
                <span>Statistiques</span>
            </a>
            <a href="parametres.html" class="nav-item">
                <i class="fas fa-cog"></i>
                <span>Paramètres</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <a href="#" class="nav-item" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Déconnexion</span>
            </a>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Bar -->
        <div class="topbar">
            <div class="topbar-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Gestion des Vols</h1>
            </div>
            
            <div class="topbar-right">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Rechercher un vol...">
                </div>
                
                <div class="notifications">
                    <i class="fas fa-bell"></i>
                    <span class="badge">12</span>
                </div>
                
                <div class="user-profile">
                    <img src="https://ui-avatars.com/api/?name=Admin+User&background=667eea&color=fff" alt="User">
                    <div class="user-info">
                        <span class="user-name">Admin User</span>
                        <span class="user-role">Administrateur</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- Filtres Avancés -->
            <div class="filters-section mb-4">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label fw-bold"><i class="fas fa-calendar me-2"></i>Période</label>
                        <select class="form-select" id="filterPeriod" onchange="applyFilters()">
                            <option value="today">Aujourd'hui</option>
                            <option value="week" selected>Cette Semaine</option>
                            <option value="month">Ce Mois</option>
                            <option value="year">Cette Année</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label fw-bold"><i class="fas fa-building me-2"></i>Compagnie</label>
                        <select class="form-select" id="filterCompany" onchange="applyFilters()">
                            <option value="all">Toutes</option>
                            <option value="Air France">Air France</option>
                            <option value="Emirates">Emirates</option>
                            <option value="Lufthansa">Lufthansa</option>
                            <option value="British Airways">British Airways</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label fw-bold"><i class="fas fa-info-circle me-2"></i>Statut</label>
                        <select class="form-select" id="filterStatus" onchange="applyFilters()">
                            <option value="all">Tous</option>
                            <option value="À l'heure">À l'heure</option>
                            <option value="Retardé">Retardé</option>
                            <option value="Annulé">Annulé</option>
                            <option value="Complet">Complet</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label fw-bold"><i class="fas fa-map-marker-alt me-2"></i>Destination</label>
                        <select class="form-select" id="filterDestination" onchange="applyFilters()">
                            <option value="all">Toutes</option>
                            <option value="Europe">Europe</option>
                            <option value="Amérique">Amérique</option>
                            <option value="Asie">Asie</option>
                            <option value="Afrique">Afrique</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons mb-4">
                <button class="btn btn-primary" onclick="openAddFlightModal()">
                    <i class="fas fa-plus me-2"></i>Ajouter un Vol
                </button>
                <button class="btn btn-success" onclick="exportFlights()">
                    <i class="fas fa-file-excel me-2"></i>Exporter Tous
                </button>
                <button class="btn btn-info" onclick="openBulkNotificationModal()">
                    <i class="fas fa-bell me-2"></i>Notifier Clients
                </button>
            </div>
            
            <!-- KPI Cards -->
            <div class="kpi-container">
                <div class="kpi-card blue">
                    <div class="kpi-icon">
                        <i class="fas fa-plane"></i>
                    </div>
                    <div class="kpi-content">
                        <div class="kpi-title">Total Vols</div>
                        <div class="kpi-value" id="totalFlights">342</div>
                        <div class="kpi-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>8.5% vs période précédente</span>
                        </div>
                    </div>
                </div>
                
                <div class="kpi-card green">
                    <div class="kpi-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="kpi-content">
                        <div class="kpi-title">Vols Aujourd'hui</div>
                        <div class="kpi-value" id="todayFlights">28</div>
                        <div class="kpi-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>+2 vs hier</span>
                        </div>
                    </div>
                </div>
                
                <div class="kpi-card orange">
                    <div class="kpi-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="kpi-content">
                        <div class="kpi-title">En Retard</div>
                        <div class="kpi-value" id="delayedFlights">3</div>
                        <div class="kpi-trend down">
                            <i class="fas fa-arrow-down"></i>
                            <span>-1 vs hier</span>
                        </div>
                    </div>
                </div>
                
                <div class="kpi-card purple">
                    <div class="kpi-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="kpi-content">
                        <div class="kpi-title">Taux d'Occupation</div>
                        <div class="kpi-value" id="occupancyRate">78%</div>
                        <div class="kpi-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>+5% vs période précédente</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Graphique 1 - Évolution du Taux d'Occupation -->
            <div class="charts-row">
                <div class="chart-card full-width">
                    <div class="chart-header">
                        <h3>Évolution du Taux d'Occupation</h3>
                        <div class="chart-controls">
                            <button class="chart-btn active" data-period="6months">6 mois</button>
                            <button class="chart-btn" data-period="1year">1 an</button>
                            <button class="chart-btn" data-period="2years">2 ans</button>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="occupancyChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Graphique 2 - Top 10 Destinations -->
            <div class="charts-row">
                <div class="chart-card full-width">
                    <div class="chart-header">
                        <h3>Top 10 Destinations</h3>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="destinationsChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Tableau des Vols -->
            <div class="table-card">
                <div class="table-header">
                    <h3><i class="fas fa-plane-departure me-2"></i>Liste des Vols</h3>
                </div>
                <div class="table-container">
                    <table class="table modern-table" id="flightsTable">
                        <thead>
                            <tr>
                                <th>N° Vol</th>
                                <th>Compagnie</th>
                                <th>Départ → Arrivée</th>
                                <th>Date & Heure</th>
                                <th>Durée</th>
                                <th>Avion</th>
                                <th>Sièges Dispo</th>
                                <th>Prix Éco</th>
                                <th>Prix Business</th>
                                <th>Prix 1ère</th>
                                <th>Statut</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-flight-id="AF-2547" data-company="Air France" data-status="À l'heure" data-destination="Amérique">
                                <td><strong>AF-2547</strong></td>
                                <td>
                                    <div class="company-cell">
                                        <img src="https://ui-avatars.com/api/?name=AF&background=0055A4&color=fff" alt="" style="width: 30px; height: 30px; border-radius: 50%;">
                                        <span>Air France</span>
                                    </div>
                                </td>
                                <td><strong>Paris</strong> → <strong>New York</strong></td>
                                <td>25 Nov 2024 - 14:30</td>
                                <td>8h30</td>
                                <td>Boeing 777</td>
                                <td><span class="seats-badge warning">45/320</span></td>
                                <td class="text-success fw-bold">850€</td>
                                <td class="text-success fw-bold">2,450€</td>
                                <td class="text-success fw-bold">5,890€</td>
                                <td><span class="status-flight ontime">À l'heure</span></td>
                                <td class="text-center">
                                    <button class="action-btn" onclick="openFlightActionModal('AF-2547')" title="Actions">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr data-flight-id="EK-0156" data-company="Emirates" data-status="Retardé" data-destination="Asie">
                                <td><strong>EK-0156</strong></td>
                                <td>
                                    <div class="company-cell">
                                        <img src="https://ui-avatars.com/api/?name=EK&background=DC0714&color=fff" alt="" style="width: 30px; height: 30px; border-radius: 50%;">
                                        <span>Emirates</span>
                                    </div>
                                </td>
                                <td><strong>Lyon</strong> → <strong>Dubaï</strong></td>
                                <td>25 Nov 2024 - 22:15</td>
                                <td>6h15</td>
                                <td>Airbus A380</td>
                                <td><span class="seats-badge critical">12/489</span></td>
                                <td class="text-success fw-bold">1,250€</td>
                                <td class="text-success fw-bold">3,850€</td>
                                <td class="text-success fw-bold">8,200€</td>
                                <td><span class="status-flight delayed">Retardé</span></td>
                                <td class="text-center">
                                    <button class="action-btn" onclick="openFlightActionModal('EK-0156')" title="Actions">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr data-flight-id="LH-1234" data-company="Lufthansa" data-status="À l'heure" data-destination="Europe">
                                <td><strong>LH-1234</strong></td>
                                <td>
                                    <div class="company-cell">
                                        <img src="https://ui-avatars.com/api/?name=LH&background=F9BA00&color=05164D" alt="" style="width: 30px; height: 30px; border-radius: 50%;">
                                        <span>Lufthansa</span>
                                    </div>
                                </td>
                                <td><strong>Paris</strong> → <strong>Berlin</strong></td>
                                <td>26 Nov 2024 - 09:45</td>
                                <td>1h50</td>
                                <td>Airbus A320</td>
                                <td><span class="seats-badge good">98/180</span></td>
                                <td class="text-success fw-bold">180€</td>
                                <td class="text-success fw-bold">650€</td>
                                <td class="text-muted">-</td>
                                <td><span class="status-flight ontime">À l'heure</span></td>
                                <td class="text-center">
                                    <button class="action-btn" onclick="openFlightActionModal('LH-1234')" title="Actions">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr data-flight-id="BA-7890" data-company="British Airways" data-status="Complet" data-destination="Europe">
                                <td><strong>BA-7890</strong></td>
                                <td>
                                    <div class="company-cell">
                                        <img src="https://ui-avatars.com/api/?name=BA&background=075AAA&color=fff" alt="" style="width: 30px; height: 30px; border-radius: 50%;">
                                        <span>British Airways</span>
                                    </div>
                                </td>
                                <td><strong>Paris</strong> → <strong>Londres</strong></td>
                                <td>26 Nov 2024 - 11:20</td>
                                <td>1h15</td>
                                <td>Boeing 737</td>
                                <td><span class="seats-badge full">0/150</span></td>
                                <td class="text-success fw-bold">120€</td>
                                <td class="text-success fw-bold">450€</td>
                                <td class="text-muted">-</td>
                                <td><span class="status-flight full">Complet</span></td>
                                <td class="text-center">
                                    <button class="action-btn" onclick="openFlightActionModal('BA-7890')" title="Actions">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr data-flight-id="AF-5623" data-company="Air France" data-status="Annulé" data-destination="Afrique">
                                <td><strong>AF-5623</strong></td>
                                <td>
                                    <div class="company-cell">
                                        <img src="https://ui-avatars.com/api/?name=AF&background=0055A4&color=fff" alt="" style="width: 30px; height: 30px; border-radius: 50%;">
                                        <span>Air France</span>
                                    </div>
                                </td>
                                <td><strong>Paris</strong> → <strong>Abidjan</strong></td>
                                <td>27 Nov 2024 - 23:55</td>
                                <td>6h30</td>
                                <td>Boeing 787</td>
                                <td><span class="seats-badge">-</span></td>
                                <td class="text-muted">780€</td>
                                <td class="text-muted">2,200€</td>
                                <td class="text-muted">4,500€</td>
                                <td><span class="status-flight cancelled">Annulé</span></td>
                                <td class="text-center">
                                    <button class="action-btn" onclick="openFlightActionModal('AF-5623')" title="Actions">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODALS ========== -->
    
    <!-- Modal Menu Actions Vol -->
    <div class="modal fade" id="flightActionModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Actions Vol <span id="actionFlightId"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-primary btn-lg" onclick="viewFlightDetails()">
                            <i class="fas fa-eye me-2"></i>Voir Détails Complets
                        </button>
                        <button class="btn btn-outline-warning btn-lg" onclick="editFlight()">
                            <i class="fas fa-edit me-2"></i>Modifier le Vol
                        </button>
                        <button class="btn btn-outline-info btn-lg" onclick="viewBookings()">
                            <i class="fas fa-list me-2"></i>Voir Réservations
                        </button>
                        <button class="btn btn-outline-success btn-lg" onclick="viewStatistics()">
                            <i class="fas fa-chart-bar me-2"></i>Statistiques du Vol
                        </button>
                        <button class="btn btn-outline-secondary btn-lg" onclick="notifyClients()">
                            <i class="fas fa-bell me-2"></i>Notifier les Clients
                        </button>
                        <button class="btn btn-outline-danger btn-lg" onclick="cancelFlight()">
                            <i class="fas fa-times-circle me-2"></i>Annuler le Vol
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Détails Vol -->
    <div class="modal fade" id="flightDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="fas fa-plane me-2"></i>Détails du Vol <span id="detailFlightId"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Informations Générales -->
                        <div class="col-md-6">
                            <h6 class="text-primary mb-3"><i class="fas fa-info-circle me-2"></i>Informations Générales</h6>
                            <div class="info-row">
                                <strong>Numéro de vol:</strong>
                                <span id="detailFlightNumber">AF-2547</span>
                            </div>
                            <div class="info-row">
                                <strong>Compagnie:</strong>
                                <span id="detailCompany">Air France</span>
                            </div>
                            <div class="info-row">
                                <strong>Type d'appareil:</strong>
                                <span id="detailAircraft">Boeing 777-300ER</span>
                            </div>
                            <div class="info-row">
                                <strong>Immatriculation:</strong>
                                <span id="detailRegistration">F-GSQJ</span>
                            </div>
                        </div>
                        
                        <!-- Itinéraire -->
                        <div class="col-md-6">
                            <h6 class="text-success mb-3"><i class="fas fa-route me-2"></i>Itinéraire</h6>
                            <div class="info-row">
                                <strong>Départ:</strong>
                                <span id="detailDeparture">Paris Charles de Gaulle (CDG)</span>
                            </div>
                            <div class="info-row">
                                <strong>Arrivée:</strong>
                                <span id="detailArrival">New York JFK (JFK)</span>
                            </div>
                            <div class="info-row">
                                <strong>Date & Heure départ:</strong>
                                <span id="detailDateTime">25 Nov 2024 - 14:30</span>
                            </div>
                            <div class="info-row">
                                <strong>Durée du vol:</strong>
                                <span id="detailDuration">8h30</span>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="row">
                        <!-- Disponibilité & Tarification -->
                        <div class="col-md-12">
                            <h6 class="text-warning mb-3"><i class="fas fa-ticket-alt me-2"></i>Disponibilité & Tarification</h6>
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Classe</th>
                                            <th>Capacité Totale</th>
                                            <th>Sièges Réservés</th>
                                            <th>Sièges Disponibles</th>
                                            <th>Taux Occupation</th>
                                            <th>Prix</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>Économique</strong></td>
                                            <td>250</td>
                                            <td>205</td>
                                            <td><span class="badge bg-success">45</span></td>
                                            <td><strong>82%</strong></td>
                                            <td><strong class="text-success">850€</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Business</strong></td>
                                            <td>50</td>
                                            <td>42</td>
                                            <td><span class="badge bg-warning">8</span></td>
                                            <td><strong>84%</strong></td>
                                            <td><strong class="text-success">2,450€</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Première Classe</strong></td>
                                            <td>20</td>
                                            <td>18</td>
                                            <td><span class="badge bg-danger">2</span></td>
                                            <td><strong>90%</strong></td>
                                            <td><strong class="text-success">5,890€</strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="row">
                        <!-- Équipage -->
                        <div class="col-md-6">
                            <h6 class="text-info mb-3"><i class="fas fa-users me-2"></i>Équipage</h6>
                            <div class="info-row">
                                <strong>Commandant:</strong>
                                <span>Capitaine Jean Moreau</span>
                            </div>
                            <div class="info-row">
                                <strong>Co-pilote:</strong>
                                <span>Lieutenant Marie Dubois</span>
                            </div>
                            <div class="info-row">
                                <strong>Personnel de cabine:</strong>
                                <span>12 membres</span>
                            </div>
                        </div>
                        
                        <!-- Statut & Météo -->
                        <div class="col-md-6">
                            <h6 class="text-secondary mb-3"><i class="fas fa-cloud-sun me-2"></i>Statut & Conditions</h6>
                            <div class="info-row">
                                <strong>Statut actuel:</strong>
                                <span class="status-flight ontime">À l'heure</span>
                            </div>
                            <div class="info-row">
                                <strong>Météo départ:</strong>
                                <span><i class="fas fa-cloud-sun text-warning"></i> Nuageux, 12°C</span>
                            </div>
                            <div class="info-row">
                                <strong>Météo arrivée:</strong>
                                <span><i class="fas fa-sun text-warning"></i> Ensoleillé, 18°C</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                    <button type="button" class="btn btn-primary" onclick="printFlightDetails()">
                        <i class="fas fa-print me-2"></i>Imprimer
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Modifier Vol -->
    <div class="modal fade" id="editFlightModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editFlightTitle">Modifier le Vol</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editFlightForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Numéro de vol <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="editFlightNumber" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Compagnie <span class="text-danger">*</span></label>
                                <select class="form-select" id="editCompany" required>
                                    <option value="">Sélectionner...</option>
                                    <option value="Air France">Air France</option>
                                    <option value="Emirates">Emirates</option>
                                    <option value="Lufthansa">Lufthansa</option>
                                    <option value="British Airways">British Airways</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Aéroport de départ <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="editDeparture" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Aéroport d'arrivée <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="editArrival" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Date & Heure <span class="text-danger">*</span></label>
                                <input type="datetime-local" class="form-control" id="editDateTime" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Durée <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="editDuration" placeholder="Ex: 8h30" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Type d'avion <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="editAircraft" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Statut <span class="text-danger">*</span></label>
                                <select class="form-select" id="editStatus" required>
                                    <option value="À l'heure">À l'heure</option>
                                    <option value="Retardé">Retardé</option>
                                    <option value="Annulé">Annulé</option>
                                    <option value="Complet">Complet</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix Économique (€)</label>
                                <input type="number" class="form-control" id="editPriceEco" min="0">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix Business (€)</label>
                                <input type="number" class="form-control" id="editPriceBusiness" min="0">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix 1ère Classe (€)</label>
                                <input type="number" class="form-control" id="editPriceFirst" min="0">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="saveFlight()">
                        <i class="fas fa-save me-2"></i>Enregistrer
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Réservations du Vol -->
    <div class="modal fade" id="bookingsModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title"><i class="fas fa-list me-2"></i>Réservations du Vol <span id="bookingsFlightId"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>ID Réservation</th>
                                    <th>Client</th>
                                    <th>Email</th>
                                    <th>Téléphone</th>
                                    <th>Classe</th>
                                    <th>Siège</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>#BK-2847</strong></td>
                                    <td>Jean Dupont</td>
                                    <td>jean.dupont@email.com</td>
                                    <td>+33 6 12 34 56 78</td>
                                    <td><span class="badge bg-warning">Business</span></td>
                                    <td>12A</td>
                                    <td class="text-success fw-bold">2,450€</td>
                                    <td><span class="status confirmed">Confirmé</span></td>
                                </tr>
                                <tr>
                                    <td><strong>#BK-2846</strong></td>
                                    <td>Marie Martin</td>
                                    <td>marie.martin@email.com</td>
                                    <td>+33 6 98 76 54 32</td>
                                    <td><span class="badge bg-primary">Économique</span></td>
                                    <td>28C</td>
                                    <td class="text-success fw-bold">850€</td>
                                    <td><span class="status confirmed">Confirmé</span></td>
                                </tr>
                                <tr>
                                    <td><strong>#BK-2845</strong></td>
                                    <td>Pierre Bernard</td>
                                    <td>pierre.bernard@email.com</td>
                                    <td>+33 6 45 67 89 01</td>
                                    <td><span class="badge bg-danger">1ère Classe</span></td>
                                    <td>1A</td>
                                    <td class="text-success fw-bold">5,890€</td>
                                    <td><span class="status confirmed">Confirmé</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                    <button type="button" class="btn btn-success" onclick="exportBookings()">
                        <i class="fas fa-file-excel me-2"></i>Exporter
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Statistiques Vol -->
    <div class="modal fade" id="statisticsModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="fas fa-chart-bar me-2"></i>Statistiques du Vol <span id="statsFlightId"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stat-box bg-primary text-white">
                                <h3>82%</h3>
                                <p>Taux de Remplissage</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box bg-success text-white">
                                <h3>265,450€</h3>
                                <p>Revenus Générés</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box bg-warning text-white">
                                <h3>265</h3>
                                <p>Passagers</p>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box bg-info text-white">
                                <h3>1,001€</h3>
                                <p>Revenu Moyen/Passager</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <h6 class="mb-3">Répartition par Classe</h6>
                            <canvas id="classDistributionChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Ajouter Vol -->
    <div class="modal fade" id="addFlightModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ajouter un Nouveau Vol</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addFlightForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Numéro de vol <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="addFlightNumber" placeholder="Ex: AF-2547" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Compagnie <span class="text-danger">*</span></label>
                                <select class="form-select" id="addCompany" required>
                                    <option value="">Sélectionner...</option>
                                    <option value="Air France">Air France</option>
                                    <option value="Emirates">Emirates</option>
                                    <option value="Lufthansa">Lufthansa</option>
                                    <option value="British Airways">British Airways</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Aéroport de départ <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="addDeparture" placeholder="Ex: Paris" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Aéroport d'arrivée <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="addArrival" placeholder="Ex: New York" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Date & Heure <span class="text-danger">*</span></label>
                                <input type="datetime-local" class="form-control" id="addDateTime" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Durée <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="addDuration" placeholder="Ex: 8h30" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Type d'avion <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="addAircraft" placeholder="Ex: Boeing 777" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Capacité totale <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="addCapacity" placeholder="320" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix Économique (€) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="addPriceEco" placeholder="850" min="0" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix Business (€)</label>
                                <input type="number" class="form-control" id="addPriceBusiness" placeholder="2450" min="0">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Prix 1ère Classe (€)</label>
                                <input type="number" class="form-control" id="addPriceFirst" placeholder="5890" min="0">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="addNewFlight()">
                        <i class="fas fa-plus me-2"></i>Ajouter le Vol
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/v/bs5/jq-3.7.0/jszip-3.10.1/dt-2.1.8/b-3.2.0/b-colvis-3.2.0/b-html5-3.2.0/b-print-3.2.0/r-3.0.3/datatables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        let currentFlightId = '';
        let flightsTable;
        
        // Initialisation DataTable
        $(document).ready(function() {
            flightsTable = $('#flightsTable').DataTable({
                responsive: false,
                scrollX: true,
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'copy',
                        className: 'btn btn-sm',
                        text: '<i class="bi bi-clipboard"></i> Copier',
                        exportOptions: { columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }
                    },
                    {
                        extend: 'csv',
                        className: 'btn btn-sm',
                        text: '<i class="bi bi-file-earmark-spreadsheet"></i> CSV',
                        exportOptions: { columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }
                    },
                    {
                        extend: 'excel',
                        className: 'btn btn-sm',
                        text: '<i class="bi bi-file-earmark-excel"></i> Excel',
                        exportOptions: { columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }
                    },
                    {
                        extend: 'pdf',
                        className: 'btn btn-sm',
                        text: '<i class="bi bi-file-earmark-pdf"></i> PDF',
                        exportOptions: { columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }
                    },
                    {
                        extend: 'print',
                        className: 'btn btn-sm',
                        text: '<i class="bi bi-printer"></i> Imprimer',
                        exportOptions: { columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }
                    },
                    'colvis'
                ],
                language: {
                    url: "https://cdn.datatables.net/plug-ins/1.13.6/i18n/fr-FR.json"
                },
                pageLength: 10,
                lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "Tout"]],
                order: [[0, 'asc']],
                columnDefs: [
                    { orderable: false, targets: 11 },
                    { width: "100px", targets: 11 },
                    { className: "text-center", targets: 11 }
                ]
            });
        });
        
        // Graphiques
        const ctxOccupancy = document.getElementById('occupancyChart').getContext('2d');
        new Chart(ctxOccupancy, {
            type: 'line',
            data: {
                labels: ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Déc'],
                datasets: [{
                    label: 'Taux d\'Occupation (%)',
                    data: [68, 72, 75, 71, 78, 82, 85, 88, 83, 79, 76, 78],
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 60,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
        
        const ctxDestinations = document.getElementById('destinationsChart').getContext('2d');
        new Chart(ctxDestinations, {
            type: 'bar',
            data: {
                labels: ['New York', 'Dubaï', 'Londres', 'Tokyo', 'Madrid', 'Berlin', 'Rome', 'Barcelone', 'Abidjan', 'Montréal'],
                datasets: [{
                    label: 'Nombre de vols',
                    data: [45, 38, 52, 28, 35, 30, 25, 32, 18, 22],
                    backgroundColor: [
                        '#667eea', '#764ba2', '#10b981', '#f59e0b', 
                        '#ef4444', '#3b82f6', '#8b5cf6', '#ec4899',
                        '#06b6d4', '#14b8a6'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });
        
        // ===== FONCTIONS FILTRES =====
        
        function applyFilters() {
            const period = $('#filterPeriod').val();
            const company = $('#filterCompany').val();
            const status = $('#filterStatus').val();
            const destination = $('#filterDestination').val();
            
            // Filtrage du DataTable
            flightsTable.search('').columns().search('').draw();
            
            if (company !== 'all') {
                flightsTable.column(1).search(company).draw();
            }
            if (status !== 'all') {
                flightsTable.column(10).search(status).draw();
            }
            
            console.log('Filtres appliqués:', { period, company, status, destination });
        }
        
        // ===== FONCTIONS ACTIONS =====
        
        function openFlightActionModal(flightId) {
            currentFlightId = flightId;
            document.getElementById('actionFlightId').textContent = flightId;
            const modal = new bootstrap.Modal(document.getElementById('flightActionModal'));
            modal.show();
        }
        
        function viewFlightDetails() {
            bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            
            document.getElementById('detailFlightId').textContent = currentFlightId;
            const modal = new bootstrap.Modal(document.getElementById('flightDetailsModal'));
            modal.show();
        }
        
        function editFlight() {
            bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            
            document.getElementById('editFlightTitle').textContent = 'Modifier le Vol ' + currentFlightId;
            // Pré-remplir le formulaire avec les données du vol
            document.getElementById('editFlightNumber').value = currentFlightId;
            
            const modal = new bootstrap.Modal(document.getElementById('editFlightModal'));
            modal.show();
        }
        
        function viewBookings() {
            bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            
            document.getElementById('bookingsFlightId').textContent = currentFlightId;
            const modal = new bootstrap.Modal(document.getElementById('bookingsModal'));
            modal.show();
        }
        
        function viewStatistics() {
            bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            
            document.getElementById('statsFlightId').textContent = currentFlightId;
            const modal = new bootstrap.Modal(document.getElementById('statisticsModal'));
            modal.show();
            
            // Graphique de distribution par classe
            setTimeout(() => {
                const ctx = document.getElementById('classDistributionChart').getContext('2d');
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Économique (205)', 'Business (42)', 'Première Classe (18)'],
                        datasets: [{
                            data: [205, 42, 18],
                            backgroundColor: ['#3b82f6', '#f59e0b', '#ef4444']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'right' }
                        }
                    }
                });
            }, 300);
        }
        
        function notifyClients() {
            if (confirm('Voulez-vous envoyer une notification à tous les passagers de ce vol ?')) {
                alert('Notification envoyée à tous les passagers du vol ' + currentFlightId);
                bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            }
        }
        
        function cancelFlight() {
            if (confirm('⚠️ Êtes-vous sûr de vouloir ANNULER ce vol ?\n\nTous les passagers seront automatiquement notifiés.')) {
                alert('Vol ' + currentFlightId + ' annulé. Les passagers ont été notifiés.');
                
                // Mettre à jour le statut dans le tableau
                const row = document.querySelector(`tr[data-flight-id="${currentFlightId}"]`);
                const statusCell = row.querySelector('.status-flight');
                statusCell.className = 'status-flight cancelled';
                statusCell.textContent = 'Annulé';
                
                bootstrap.Modal.getInstance(document.getElementById('flightActionModal')).hide();
            }
        }
        
        function saveFlight() {
            alert('Vol modifié avec succès !');
            bootstrap.Modal.getInstance(document.getElementById('editFlightModal')).hide();
        }
        
        function printFlightDetails() {
            window.print();
        }
        
        function exportBookings() {
            alert('Export des réservations en cours...');
        }
        
        // ===== FONCTIONS GÉNÉRALES =====
        
        function openAddFlightModal() {
            document.getElementById('addFlightForm').reset();
            const modal = new bootstrap.Modal(document.getElementById('addFlightModal'));
            modal.show();
        }
        
        function addNewFlight() {
            const flightNumber = document.getElementById('addFlightNumber').value;
            
            if (!flightNumber) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }
            
            alert('Nouveau vol ' + flightNumber + ' ajouté avec succès !');
            bootstrap.Modal.getInstance(document.getElementById('addFlightModal')).hide();
            
            // Ici tu peux ajouter la logique pour ajouter une ligne au tableau
        }
        
        function exportFlights() {
            alert('Export de tous les vols en cours...');
        }
        
        function openBulkNotificationModal() {
            alert('Fonctionnalité de notification groupée à venir');
        }
        
        // Menu Toggle
        document.getElementById('menuToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });
    </script>
    
    <style>
        /* Filtres */
        .filters-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .action-buttons .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
        }
        
        /* Company Cell */
        .company-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Seats Badge */
        .seats-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .seats-badge.good {
            background: #d1fae5;
            color: #065f46;
        }
        
        .seats-badge.warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .seats-badge.critical {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .seats-badge.full {
            background: #e5e7eb;
            color: #6b7280;
        }
        
        /* Status Flight */
        .status-flight {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-flight.ontime {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-flight.delayed {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-flight.cancelled {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .status-flight.full {
            background: #dbeafe;
            color: #1e40af;
        }
        
        /* Info Row */
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        /* Stat Box */
        .stat-box {
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-box h3 {
            font-size: 32px;
            margin-bottom: 5px;
        }
        
        .stat-box p {
            margin: 0;
            font-size: 14px;
        }
        
        /* Action Button */
        .action-btn {
            background: white;
            border: 1px solid #e5e7eb;
            padding: 8px 12px !important;
            border-radius: 6px;
            cursor: pointer;
            color: #6b7280;
            transition: all 0.3s;
            font-size: 16px !important;
        }
        
        .action-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        /* Table Compact */
        #flightsTable {
            font-size: 13px;
        }
        
        #flightsTable thead th,
        #flightsTable tbody td {
            padding: 10px 8px !important;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .filters-section .col-md-3 {
                margin-bottom: 10px;
            }
        }
    </style>
</body>
</html>